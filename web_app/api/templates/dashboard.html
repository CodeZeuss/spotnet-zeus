{% extends "base.html" %}

{% block title %}
    Dashboard
{% endblock %}

{% block content %}
    <div class="container py-4">
        <h2 class="mb-4">Dashboard</h2>

        <!-- Token Balances Table -->
        <div class="mb-4">
            <h4>Your Token Balances</h4>
            <div class="table-responsive">
                <table class="table table-bordered table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th scope="col">Token</th>
                            <th scope="col">Balance</th>
                            <th scope="col">Multiplier</th>
                            <th scope="col">Start Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for token, balance in balances.items() %}
                            <tr>
                                <td>{{ token }}</td>
                                <td>{{ balance }}</td>
                                <td>{{ multipliers.get(token, "N/A") }}</td>
                                <td>{{ start_dates.get(token, "N/A") }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- zkLend Position Section -->
        {% if zklend_position %}
            <div class="mb-4">
                <h4>zkLend Position</h4>

                <!-- Health Factor and Loan-to-Value -->
                <div class="card mb-3">
                    <div class="card-body">
                        <div class="row">
{#                            <div class="col-md-6">#}
{#                                <p><strong>Loan-to-value:</strong> 67%</p>#}
{#                            </div>#}
                            <div class="col-md-6">
                                <p><strong>Health factor:</strong> {{ zklend_position.dapps[0].products[0].groups['1'].health_ratio }}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Collateral and Borrow Section -->
                <div class="row">
                    <!-- Collateral Section -->
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header bg-success text-white">
                                Collateral & Earning
                            </div>
                            <div class="card-body">
                                <h5 class="card-title">Ethereum</h5>
                                <p><strong>Balance:</strong> {{ zklend_position.dapps[0].products[0].positions[0].total_balances['0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7'] }}</p>
                                <p><strong>APY:</strong> {{ zklend_position.dapps[0].products[0].positions[0].data.apy }}%</p>
                            </div>
                        </div>
                    </div>

                    <!-- Borrow Section -->
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header bg-danger text-white">
                                Borrow
                            </div>
                            <div class="card-body">
                                <h5 class="card-title">USD Coin</h5>
                                <p><strong>Balance:</strong> {{ zklend_position.dapps[0].products[0].positions[1].total_balances['0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8'] }}</p>
                                <p><strong>APY:</strong> {{ zklend_position.dapps[0].products[0].positions[1].data.apy }}%</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Manage Button -->
                <div class="mt-4 text-center">
                    <a href="{{ zklend_position.dapps[0].products[0].manage_url }}" class="btn btn-primary">Manage Your zkLend Position</a>
                </div>
            </div>
        {% else %}
            <div class="alert alert-info">No zkLend position data available.</div>
        {% endif %}
    </div>

    <script>
        // Optional interactivity or custom JavaScript for the dashboard
    </script>
{% endblock %}